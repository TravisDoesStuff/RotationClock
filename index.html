<!-- 2013-2014, Travis Burt -->
<!-- Last Updated: 2/29/14 -->

<!DOCTYPE html>
<html>
<head>
<title>Rotation Clock</title>
<style>
body{
	background-color: black;
	color: white;
	font-family: "Arial" "Times New Roman";
}
canvas{
	margin: auto;
	display: block;
}
</style>
<script>
function rotation()
{
	//below is a perfect example of why OOP is important

	//get time and convert to rads/degrees
	var date = new Date();

	var fract_second = date.getMilliseconds()/1000; //returns 0-999
	var deg_second = fract_second*360;

	var seg_minute = 360/60;
	var fract_minute = date.getSeconds()/60; //returns 0-59
	var deg_minute = (fract_minute*360) + (fract_second * seg_minute);
	var rad_minute = deg_minute*(Math.PI/180); //convert to radians

	var seg_hour = 360/60;
	var fract_hour = date.getMinutes()/60; //returns 0-59
	var deg_hour = (fract_hour*360) + (seg_hour * fract_minute);
	var rad_hour = deg_hour*(Math.PI/180);

	var seg_day = 360/24;
	var fract_day = date.getHours()/24; //returns 0-23
	var deg_day = (fract_day*360) + (seg_day * fract_hour);
	var rad_day = deg_day*(Math.PI/180);

	var max = maxMonth();
	var seg_month = 360/max;
	var fract_month = (date.getDate()-1)/max; //.getDate returns 1-31
	var deg_month = (fract_month*360) + (seg_month * fract_day);
	var rad_month = deg_month*(Math.PI/180);



	var seg_year = 360/12;
	var fract_year = date.getMonth()/12; //returns 0-11
	var deg_year = (fract_year*360) + (seg_year * fract_month);
	var rad_year = deg_year*(Math.PI/180);


	//day of the week
	var seg_week = 360/7;
	var fract_week = date.getDay()/7;
	var deg_week = (fract_week*360) + (seg_week * fract_day);
	var rad_week = deg_week*(Math.PI/180);


	//moon cycle
	//is 29.530588853 days
	//because the moon moves with the earth around the sun
	var firstMoon = (date.getTime()/1000/86400)+22.58;
	var moonPhase = firstMoon%29.53;
	var fract_moon = moonPhase/29.53;
	var deg_moon = fract_moon*360;
	var rad_moon = deg_moon*(Math.PI/180);

	var r_deg_second = Math.round(fract_second*360);
	var r_deg_minute = Math.round((fract_minute*360) + (seg_minute * fract_second));
	var r_deg_hour = Math.round((fract_hour*360) + (seg_hour * fract_minute));
	var r_deg_day = Math.round((fract_day*360) + (seg_day * fract_hour));
	var r_deg_month = Math.round((fract_month*360) + (seg_month * fract_day));
	var r_deg_year = Math.round((fract_year*360) + (seg_year * fract_month));
	var r_deg_week = Math.round((fract_week*360) + (seg_week * fract_day));

	/*
	document.getElementById("second").innerHTML = "Second: "+r_deg_second+"&deg";
	document.getElementById("minute").innerHTML = "Minute: "+r_deg_minute+"&deg";
	document.getElementById("hour").innerHTML = "Hour: "+r_deg_hour+"&deg";
	document.getElementById("day").innerHTML = "Day: "+r_deg_day+"&deg";
	//document.getElementById("week").innerHTML = "<i>Week: "+r_deg_week+"&deg</i>";
	document.getElementById("month").innerHTML = "Month: "+r_deg_month+"&deg";
	document.getElementById("year").innerHTML = "Year: "+r_deg_year+"&deg";
	//document.getElementById("moonClock").innerHTML = deg_moon+"&deg";
	*/

//------------------------------------------------------------------------------------------------
//draw clock
	var canvas = document.getElementById("clock");
	var ctx = canvas.getContext("2d");

	//clear frame every millisecond
	ctx.clearRect(0, 0, canvas.width, canvas.height);

	//ctx.arc(x-coord, y-coord, radius, start-radians, stop-radians)

	//draw second
	ctx.beginPath();
	ctx.arc(400, 225, 10, 2*fract_second*Math.PI, 2*fract_second*Math.PI-3);
	ctx.lineWidth = 5;
	ctx.strokeStyle = "white";
	ctx.stroke();

	//draw minute circle
	ctx.beginPath();
	ctx.arc(400, 225, 200, 1.5*Math.PI, rad_minute-1.57);
	ctx.lineWidth = 15;
	ctx.strokeStyle = "coral";
	ctx.stroke();

	//draw hour circle
	ctx.beginPath();
	ctx.arc(400, 225, 160, 1.5*Math.PI, rad_hour-1.57);
	ctx.lineWidth = 5;
	ctx.strokeStyle = "lightslategray";
	ctx.stroke();

	//draw day circle
	ctx.beginPath();
	ctx.arc(400, 225, 100, 1.5*Math.PI, rad_day-1.57);
	ctx.lineWidth = 12;
	ctx.strokeStyle = "springgreen";
	ctx.stroke();

	//draw month circle
	ctx.beginPath();
	ctx.arc(400, 225, 60, 1.5*Math.PI, rad_month-1.57);
	ctx.lineWidth = 4;
	ctx.strokeStyle = "silver";
	ctx.stroke();

	//draw year circle
	ctx.beginPath();
	ctx.arc(400, 225, 35, 1.5*Math.PI, rad_year-1.57);
	ctx.lineWidth = 8;
	ctx.strokeStyle = "steelblue";
	ctx.stroke();

//--------------------------------------------------------------------------------------
	//display time text
	var seconds = date.getSeconds();
	var minutes = date.getMinutes();
	var hours = date.getHours();

	if(seconds<10) seconds = "0"+seconds;
	if(minutes<10) minutes = "0"+minutes;
	if(hours<10) hours = "0"+hours;

	//12 hour clock
	var ap = "am"
	if(hours>=12)
	{
		(hours==12 ? hours=12 : hours=hours-12);
		ap = "pm"
	}
	//if(hours<10) hours = " "+hours;
	if(hours==0) hours = 12;

	ctx.font="18px Lucida Console"; //some browsers do not support this font
	ctx.fillStyle="white";
	ctx.fillText(hours+":"+minutes+":"+seconds+ap, 350, 480);
	ctx.fillText(date.getMonth()+1+"/"+date.getDate()+"/"+date.getFullYear(), 350, 500);
}
function maxMonth()
{
	var date = new Date();
	var d = date.getMonth()+1;

	//February, check for leap years
	if((date.getYear()%4) == 0) return 29;
	if(d == 2) return 28;

	//January, March, May, July, August, October, and December have 31 days
	if(d<8)
	{
		if((d%2) == 1) return 31;
		else return 30;
	}
	else
	{
		if((d%2) == 0) return 31;
		else return 30;
	}
}
setInterval(function(){rotation()}, 16);
</script>
</head>

<body>
<canvas id="clock" width="800" height="580">
Your browser does not support HTML5 canvas or you have JavaScript disabled!
</canvas>
</body>
</html>
